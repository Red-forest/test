function setHeadMenu(){var e=document.location.href.split("/")[3],t=$(".m-menu"),a=$(".m-menu > div >a");if(t)switch(e){case"space":$(a[1]).addClass("m-defaultshort");break;case"rmsearch":$(a[2]).addClass("m-defaultshort");break;case"say":$(a[3]).addClass("m-defaultshort");break;case"anli":$(a[4]).addClass("m-defaultlong");break;case"":$(a[0]).addClass("m-defaultshort")}}function show(e,t){$(e).focus(),"none"==$("#"+t).css("display")?$("#"+t).css("display","block"):$("#"+t).css("display","none"),$(e).blur(function(){$("#"+t).css("display","none")})}var tools=new function(){_self=this,_self.randomChar=function(e){for(var t="0123456789qwertyioplkjhgfsazxcvbnm",a="",n=0;e>n;n++)a+=t.charAt(Math.ceil(1e8*Math.random())%t.length);return a},_self.getCharLen=function(e){return e.replace(/[^\x00-\xff]/g,"rr").length},_self.imgCenter=function(e,t){var a=new Image;a.src=e.src;var n=a.height;if(n>0){var r=(t-n)/2;$(e).css("margin-top",r)}},_self.subStr=function(e,t,a){var n=!1;if(tools.getCharLen(e)>t){a=a?a:"",t-=tools.getCharLen(a);for(var r=escape(e),s=r.length,o="",i=0,c=0;s>c;c++){if(!(t>i)){n=!0;break}var l=r.charAt(c);"%"==l?(l=r.charAt(c+1),"u"==l?(o+=r.substring(c,c+6),i+=2,c+=5):(o+=r.substring(c,c+3),i++,c+=2)):(o+=l,i++)}}return n?unescape(o)+a:e},_self.xss=function(e,t){return e=e.replace(/<(script|link|style|iframe)(.|\n)*\/\1>\s*/gi,""),1==t&&(e=e.replace(/<\/?(?!br|\/)[^>]*>/g,"")),e=e.replace(/[ | ]*\n/g,"\n")},_self.getPara=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):""},_self.subTime=function(e,t){var a,n=new Date(e);return a=void 0==t?new Date:new Date(t),(a.getTime()-n.getTime())/1e3},_self.formatTime=function(e,t){var a=new Date;t&&(a=new Date(t.replace("T"," ").replace(/-/g,"/").split(".")[0]));var n={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};t&&(n["h+"]=n["h+"]+8),/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return e},_self.format=function(e,t){var a=new Date(e),n=function(e){return(10>e?"0":"")+e};return t.toString().replace(/yyyy|MM|dd|hh|mm|ss/g,function(e){switch(e){case"yyyy":return n(a.getFullYear());case"MM":return n(a.getMonth()+1);case"mm":return n(a.getMinutes());case"dd":return n(a.getDate());case"hh":return n(a.getHours());case"ss":return n(a.getSeconds())}})},_self.getCsrf=function(e){return e?"&_csrf="+parent.$("#csrf").val():"&_csrf="+$("#csrf").val()},_self.getObjectIdTime=function(e,t){var a=parseInt(e.substring(0,8),16),n=new Date(1e3*a),r={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var s in r)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[s]:("00"+r[s]).substr((""+r[s]).length)));return t}},pageCookie=new function(){var e=this;e.getCookie=function(e){for(var t="0",a=document.cookie,n=a.split(";"),r=0;r<n.length;r++)if($.trim(n[r].split("=")[0])==e){t=decodeURI(n[r].split("=")[1]);break}return t},e.setCookie=function(e,t,a,n,r){var s=e+"="+t+"="+a;s+=n?"; max-age="+24*n*60*60:"",s+=r?"; path="+r:"; path=/",document.cookie=s}},spaceLayer=new function(){var e=this;e.iframe=function(e,t,a,n,r){r?parent.$.layer({type:2,maxmin:!1,shadeClose:!1,title:a,shade:[.5,"#fff"],offset:["150px",""],area:[e+"px",t+"px"],iframe:{src:n,scrolling:"no"}}):$.layer({type:2,maxmin:!1,shadeClose:!1,title:a,shade:[.5,"#fff"],offset:["150px",""],area:[e+"px",t+"px"],iframe:{src:n,scrolling:"no"}})},e.alert=function(e,t,a,n){t=t?t:5,a=a?a:"错误",n?layer.alert(e,t,a,n):layer.alert(e,t,a)},e.tips=function(e,t,a,n,r){$(".xubox_tips").length>0&&layer.closeTips(),n=n?n:3,a=a?a:"line-height:30px;font-size:18px;",r=r?r:"",layer.tips(t,"#"+e,{guide:r,style:["background-color:#fff; color:#000;font-size:18px;line-height:47px;"+a,"#fff"],time:n})},e.tipForm=function(e,t,a){$(e).on("click",function(){var e=$(t);e.css({display:"block"}).focus(),a&&e.on("blur",function(){e.css({display:"none"})})})}},areaCheck=function(e,t,a,n,r){var s=this;s.obj=$(e),s.maxLen=t,s.filter=r,s.defaultStr=a,s.tipObj=$(n),s.focus=function(){s.obj.bind("focus",function(){var e=$.trim(s.obj.val());e==s.defaultStr&&s.obj.val("")})},s.keyEvent=function(){s.obj.bind("keydown",function(){s.keyCheck()}),s.obj.bind("keyup",function(){s.keyCheck()})},s.keyCheck=function(){var e=$.trim(s.obj.val());s.filter&&(e=e.replace(/(\n)/g,"").replace(/(\t)/g,"").replace(/(\r)/g,"").replace(/\s*/g,""));var t=tools.getCharLen(e);s.tipObj.html(t<s.maxLen?"还能输入<i>"+parseInt(parseInt(s.maxLen-t)/2)+"</i>个字":"您已超出<i>"+parseInt((t-s.maxLen)/2)+"</i>个字")}},labInput=function(e,t){var a=this,n=$(e);a.inputFocus=function(){n.bind("focus",function(){$.trim(n.val())==t&&n.val("")})},a.inputBlur=function(){n.bind("blur",function(){""==$.trim(n.val())&&n.val(t)})}};setHeadMenu();var siteDom={avatar:"http://rm-avatar.b0.upaiyun.com",photo:"http://rm-photo.b0.upaiyun.com",say:"http://rm-say.b0.upaiyun.com"},siteData={know:["高中","中专","大专","学士","硕士","博士","博士后"]},LoginModule=new function(){var e=this;e.remPassword=function(e){var t=$(e).find("em");"noremember"==t.attr("class")?(t.removeClass("noremember"),t.addClass("rememberok")):(t.removeClass("rememberok"),t.addClass("noremember"))},e.login=function(){var e=$.trim($("#username").val()),t=$.trim($("#password").val());if(""==e||""==t)return void spaceLayer.alert("用户名和密码不能为空");$("#logsubmit").click();var a="rememberok"==$("#f-cb").attr("class")?!0:!1;$.ajax({type:"post",url:"/index/login",data:"name="+e+"&password="+t+"&_csrf="+$("#csrf").val()+"&issave="+a,dataType:"json",success:function(e){"true"==e.state?document.location.href="/space/":spaceLayer.alert("帐号或者密码错误，请重新登录")}})},e.keydown=function(e){13==e.keyCode&&LoginModule.login()},e.loginOut=function(){$.ajax({type:"post",url:"/index/loginout",data:tools.getCsrf(),dataType:"json",success:function(){layer.msg("已经退出登录",1,function(){document.location.href="/"})}})},e.checkLogin=function(){var e=pageCookie.getCookie("id");if("0"!=e){var t=unescape(pageCookie.getCookie("avatar")),a=pageCookie.getCookie("nickname"),n=document.location.href.split("/")[3].replace("#","");if("space"==n){var r='<span><a href="/space/">'+a+'</a>|<a href="javascript:void(0);" onclick="LoginModule.loginOut();">退出</a></span><img src="'+siteDom.avatar+t+'!v1">';$(".m-showhead").html(r)}else{var r='<div class="m-showhead"><span><a href="/space/">'+a+'</a>|<a href="javascript:void(0);" onclick="LoginModule.loginOut();">退出</a></span><img src="'+siteDom.avatar+t+'!v1"></div>';$(".f-fun").html(r)}}}};setTimeout(function(){LoginModule.checkLogin()},100),$(window).unbind();